var Z=Object.defineProperty,x=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var Q=(a,e,t)=>e in a?Z(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,h=(a,e)=>{for(var t in e||(e={}))te.call(e,t)&&Q(a,t,e[t]);if(q)for(var t of q(e))ae.call(e,t)&&Q(a,t,e[t]);return a},B=(a,e)=>x(a,ee(e));import{S as se,i as ne,s as ie,M as re,k as b,e as $,t as v,N as oe,d as I,m as F,c as R,a as O,h as S,b as c,g as D,H as T,O as K,P as le,j as ce,Q as _e,L as A,R as z,T as ue,U as G}from"../chunks/vendor-966ec74d.js";import{c as k}from"../chunks/singletons-d1fb5791.js";import{INMATE_SEARCH_MODE as W}from"./inmate/_mode_/_firstName_-_lastName_.svelte-1973933b.js";k.disable_scroll_handling;const J=k.goto;k.invalidate;k.prefetch;k.prefetch_routes;k.before_navigate;k.after_navigate;const P={method:"get"},H={method:"post"},X={method:"put"},he={method:"delete"},Y={"Content-Type":"application/json;charset=utf-8"},p="http://localhost:8080";class V{static async getAllFacilities(){if(this.cachedFacilities.length>0)return this.cachedFacilities;const e=await fetch(this.URI_GET_FACILITIES,B(h({},P),{headers:h({},Y)}));if(e.status!==200)throw new Error(`unexpected response ${e.status} when retrieving list of facilities from ${this.URI_GET_FACILITIES}`);return this.cachedFacilities=await e.json(),this.cachedFacilities}}V.URI_GET_FACILITIES=`${p}/getAllFacilities`;V.cachedFacilities=[];class C{static async createPackage(e){const t=await fetch(this.URI_CREATE_PACKAGE,B(h({},H),{headers:h({},Y),body:JSON.stringify(e)}));if(t.status!==200)throw new Error(`unexpected response ${t.status} when creating package: ${JSON.stringify(e)}`);return await t.json()}static async createPackageForInmateNoID(e){const t=await fetch(this.URI_CREATE_PACKAGE__INMATE_NO_ID,B(h({},H),{headers:h({},Y),body:JSON.stringify(e)}));if(t.status!==200)throw new Error(`unexpected response ${t.status} when creating package: ${JSON.stringify(e)}`);return await t.json()}static async deletePackage(e){const t=await fetch(this.URI_DELETE_PACKAGE(e),h({},he));if(t.status!==200)throw new Error(`unexpected response ${t.status} when deleting package with ID ${e} from ${this.URI_DELETE_PACKAGE(e)}`);return!0}static async updatePackage(e){const t=await fetch(this.URI_UPDATE_PACKAGE,B(h({},X),{headers:h({},Y),body:JSON.stringify(e)}));if(t.status!==200)throw new Error(`unexpected response ${t.status} when updating package at "${this.URI_UPDATE_PACKAGE}" with details: ${JSON.stringify(e)}`);return await t.json()}static async getPackagesForInmate(e){const t=await fetch(this.URI_GET_PACKAGES(e),h({},P));if(t.status!==200)throw new Error(`unexpected response ${t.status} when retrieving packages for inmate with ID "${e} at "${this.URI_GET_PACKAGES}""`);return await t.json()}static async getPackagesForInmateNoID(e){const t=await fetch(this.URI_GET_PACKAGES__INMATE_NO_ID(e),h({},P));if(t.status!==200)throw new Error(`unexpected response ${t.status} when retrieving packages for no-ID inmate with databaseID "${e} at "${this.URI_GET_PACKAGES__INMATE_NO_ID}""`);return await t.json()}static async getPackageCount(e){return await(await fetch(this.URI_PACKAGE_COUNT(e),h({},P))).json()}}C.URI_GET_PACKAGES=a=>`${p}/getPackagesForInmate?inmateId=${a}`;C.URI_GET_PACKAGES__INMATE_NO_ID=a=>`${p}/getPackagesForInmateNoId?inmateId=${a}`;C.URI_CREATE_PACKAGE=`${p}/addPackage`;C.URI_CREATE_PACKAGE__INMATE_NO_ID=`${p}/addPackageForInmateNoId`;C.URI_UPDATE_PACKAGE=`${p}/updatePackage`;C.URI_DELETE_PACKAGE=a=>`${p}/deletePackage?packageId=${a}`;C.URI_PACKAGE_COUNT=a=>`${p}/getPackageCountFromDate?date=${a}`;class y{static async getInmate(e){const t=await fetch(this.URI_GET_INMATE(e),h({},P));if(t.status===204)return null;if(t.status!==200)throw new Error(`unexpected response ${t.status} when searching for inmate with ID "${e}" at "${this.URI_GET_INMATE(e)}"`);return await t.json()}static async getInmateNoIdByDatabaseID(e){const t=await fetch(this.URI_GET_INMATE__NO_ID__BY_DATABASE_ID(e),h({},P));if(t.status!==200)throw new Error(`unexpected response ${t.status} when searching for no-ID inmate with database-ID "${e}" at "${this.URI_GET_INMATE__NO_ID__BY_DATABASE_ID(e)}"`);return await t.json()}static async getInmateNoIdByName({firstName:e,lastName:t}){const s=await fetch(this.URI_GET_INMATE__NO_ID__BY_NAME({firstName:e,lastName:t}),h({},P));if(s.status!==200)throw new Error(`unexpected response ${s.status} when searching for no-ID inmate with name "${t}, ${e}" at "${this.URI_GET_INMATE__NO_ID__BY_NAME({firstName:e,lastName:t})}"`);return await s.json()}static async createInmate({firstName:e,lastName:t,inmateId:s}){const r=await fetch(this.URI_CREATE_INMATE({firstName:e,lastName:t,inmateId:s}),h({},H));if(r.status!==200)throw new Error(`unexpected response ${r.status} when creating inmate at "${this.URI_CREATE_INMATE({firstName:e,lastName:t,inmateId:s})}" with details: ${JSON.stringify({firstName:e,lastName:t,inmateId:s})}`);return await r.json()}static async createInmateNoID({firstName:e,lastName:t,location:s}){const r=await fetch(this.URI_CREATE_INMATE__NO_ID({firstName:e,lastName:t,location:s.facility_name}),h({},H));if(r.status!==200)throw new Error(`unexpected response ${r.status} when creating no-ID inmate at "${this.URI_CREATE_INMATE__NO_ID({firstName:e,lastName:t,location:s.facility_name})}" with details: ${JSON.stringify({firstName:e,lastName:t,location:s})}`);return await r.json()}static async updateInmate({initialId:e,firstName:t,lastName:s,inmateId:r}){const l=await fetch(this.URI_UPDATE_INMATE({initialId:e,firstName:t,lastName:s,inmateId:r}),h({},X));if(l.status!==200)throw new Error(`unexpected response ${l.status} when updating inmate at "${this.URI_UPDATE_INMATE({initialId:e,firstName:t,lastName:s,inmateId:r})}" with details: ${JSON.stringify({firstName:t,lastName:s,inmateId:r})}`);return await l.json()}}y.URI_GET_INMATE=a=>`${p}/getInmate?id=${a}`;y.URI_GET_INMATE__NO_ID__BY_DATABASE_ID=a=>`${p}/getInmateNoIDByDatabaseID?id=${a}`;y.URI_GET_INMATE__NO_ID__BY_NAME=({firstName:a,lastName:e})=>`${p}/getInmateNoID?firstName=${a}&lastName=${e}`;y.URI_CREATE_INMATE=({firstName:a,lastName:e,inmateId:t})=>`${p}/addInmate?firstName=${a}&lastName=${e}&id=${t}`;y.URI_CREATE_INMATE__NO_ID=({firstName:a,lastName:e,location:t})=>`${p}/addInmateNoID?firstName=${a}&lastName=${e}&location=${t}`;y.URI_UPDATE_INMATE=({initialId:a,firstName:e,lastName:t,inmateId:s})=>`${p}/updateInmate?originalId=${a}&firstName=${e}&lastName=${t}&id=${s}`;const Ie=a=>{const e=a.getFullYear();let t=a.getMonth()+1,s=a.getDate();return`${e}-${t<10?"0":""}${t}-${s<10?"0":""}${s}`};function Ee(a){let e,t,s,r,l,_,i,u,m,f;return{c(){e=$("input"),t=b(),s=$("input"),r=b(),l=b(),_=$("button"),i=v("Search"),this.h()},l(n){e=R(n,"INPUT",{id:!0,type:!0,name:!0,placeholder:!0,class:!0}),t=F(n),s=R(n,"INPUT",{id:!0,type:!0,name:!0,placeholder:!0,class:!0}),r=F(n),l=F(n),_=R(n,"BUTTON",{type:!0,class:!0});var o=O(_);i=S(o,"Search"),o.forEach(I),this.h()},h(){c(e,"id","inmateFirstName"),c(e,"type","text"),c(e,"name","inmateFirstName"),c(e,"placeholder","First Name"),c(e,"class","svelte-l9thdr"),c(s,"id","inmateLastName"),c(s,"type","text"),c(s,"name","inmateLastName"),c(s,"placeholder","Last Name"),c(s,"class","svelte-l9thdr"),c(_,"type","submit"),_.disabled=u=!a[1].firstName||!a[1].lastName,c(_,"class","svelte-l9thdr")},m(n,o){D(n,e,o),G(e,a[1].firstName),D(n,t,o),D(n,s,o),G(s,a[1].lastName),D(n,r,o),D(n,l,o),D(n,_,o),T(_,i),m||(f=[K(e,"input",a[9]),K(s,"input",a[10])],m=!0)},p(n,o){o&34&&e.value!==n[1].firstName&&G(e,n[1].firstName),o&34&&s.value!==n[1].lastName&&G(s,n[1].lastName),o&34&&u!==(u=!n[1].firstName||!n[1].lastName)&&(_.disabled=u)},d(n){n&&I(e),n&&I(t),n&&I(s),n&&I(r),n&&I(l),n&&I(_),m=!1,z(f)}}}function fe(a){let e,t,s;return{c(){e=$("input"),this.h()},l(r){e=R(r,"INPUT",{id:!0,type:!0,placeholder:!0,name:!0,class:!0}),this.h()},h(){c(e,"id","inmateId"),c(e,"type","text"),c(e,"placeholder","Enter Inmate ID #, press Enter"),c(e,"name","inmateNumber"),c(e,"class","svelte-l9thdr")},m(r,l){D(r,e,l),G(e,a[1].id),t||(s=K(e,"input",a[8]),t=!0)},p(r,l){l&34&&e.value!==r[1].id&&G(e,r[1].id)},d(r){r&&I(e),t=!1,s()}}}function de(a){return{c:A,l:A,m:A,p:A,d:A}}function me(a){let e,t,s,r=a[16]+"",l,_,i,u;return{c(){e=$("p"),t=v("You have completed "),s=$("span"),l=v(r),_=v(" packages on "),i=$("date"),u=v(a[4]),this.h()},l(m){e=R(m,"P",{});var f=O(e);t=S(f,"You have completed "),s=R(f,"SPAN",{id:!0,class:!0});var n=O(s);l=S(n,r),n.forEach(I),_=S(f," packages on "),i=R(f,"DATE",{});var o=O(i);u=S(o,a[4]),o.forEach(I),f.forEach(I),this.h()},h(){c(s,"id","packageCount"),c(s,"class","svelte-l9thdr")},m(m,f){D(m,e,f),T(e,t),T(e,s),T(s,l),T(e,_),T(e,i),T(i,u)},p:A,d(m){m&&I(e)}}}function pe(a){return{c:A,l:A,m:A,p:A,d:A}}function Ne(a){let e,t,s,r,l,_,i,u,m;function f(d,g){if(d[0]===w.ID)return fe;if(d[0]===w.NAME_AND_LOCATION)return Ee}let n=f(a),o=n&&n(a),N={ctx:a,current:null,token:null,hasCatch:!1,pending:pe,then:me,catch:de,value:16};return re(a[6],N),{c(){e=b(),t=$("main"),s=$("form"),o&&o.c(),r=b(),l=$("p"),_=v(a[2]),i=b(),N.block.c(),this.h()},l(d){oe('[data-svelte="svelte-1h9imok"]',document.head).forEach(I),e=F(d),t=R(d,"MAIN",{class:!0});var U=O(t);s=R(U,"FORM",{class:!0});var j=O(s);o&&o.l(j),j.forEach(I),r=F(U),l=R(U,"P",{id:!0,class:!0});var L=O(l);_=S(L,a[2]),L.forEach(I),i=F(U),N.block.l(U),U.forEach(I),this.h()},h(){document.title="BellBooks",c(s,"class","svelte-l9thdr"),c(l,"id","toggleSearch"),c(l,"class","svelte-l9thdr"),c(t,"class","svelte-l9thdr")},m(d,g){D(d,e,g),D(d,t,g),T(t,s),o&&o.m(s,null),T(t,r),T(t,l),T(l,_),T(t,i),N.block.m(t,N.anchor=null),N.mount=()=>t,N.anchor=null,u||(m=[K(s,"submit",le(a[7])),K(l,"click",a[3])],u=!0)},p(d,[g]){a=d,n===(n=f(a))&&o?o.p(a,g):(o&&o.d(1),o=n&&n(a),o&&(o.c(),o.m(s,null))),g&4&&ce(_,a[2]),_e(N,a,g)},i:A,o:A,d(d){d&&I(e),d&&I(t),o&&o.d(),N.block.d(),N.token=null,N=null,u=!1,z(m)}}}var w;(function(a){a.ID="id",a.NAME_AND_LOCATION="name_and_location"})(w||(w={}));function Ae(a,e,t){let s;const r=E=>`/overview/${E}`,l=({firstName:E,lastName:M})=>`/inmate/${W.CREATE}/${E}-${M}`,_=({firstName:E,lastName:M})=>`/inmate/${W.DISAMBIGUATION}/${E}-${M}`;let i={id:null,firstName:null,lastName:null,location:null},u=w.ID;const m=()=>{u===w.ID?t(0,u=w.NAME_AND_LOCATION):t(0,u=w.ID)},f=Ie(new Date);let n=V.getAllFacilities(),o=C.getPackageCount(f);const N=async()=>{if(u===w.ID){if(i.id===null)return;try{if(await y.getInmate(i.id)===null){alert(`Failed to find an inmate with ID "${i.id}"`);return}J(r(i.id));return}catch(E){alert("Communication with server failed. Check that the server is running and not in a failing state."),console.error(E);return}}else if(u===w.NAME_AND_LOCATION)try{const E=await y.getInmateNoIdByName({firstName:i.firstName,lastName:i.lastName});if(E===null||E.length===0){if(confirm(`Failed to find any inmates named "${i.firstName} ${i.lastName}". To create a new inmate, click OK`)){J(l({firstName:i.firstName,lastName:i.lastName}));return}return}if(E.length>1&&J(_({firstName:i.firstName,lastName:i.lastName})),E.length===1){const M=E[0];J(r(M.id))}}catch(E){alert("Communication with server failed. Check that the server is running and not in a failing state."),console.error(E);return}};function d(){i.id=this.value,t(1,i),t(5,n)}function g(){i.firstName=this.value,t(1,i),t(5,n)}function U(){i.lastName=this.value,t(1,i),t(5,n)}function j(){i.location=ue(this),t(1,i),t(5,n)}const L=E=>console.log(i.location);return a.$$.update=()=>{a.$$.dirty&1&&t(2,s=u===w.ID?"Search by Name if no ID is available":"Search by Inmate ID")},[u,i,s,m,f,n,o,N,d,g,U,j,L]}class $e extends se{constructor(e){super();ne(this,e,Ae,Ne,ie,{})}}export{w as VALID_SEARCHES,$e as default};
